<%- breadcrumb %>
<script>
    var dataChart = JSON.parse('<%- JSON.stringify(data) %>');
    var companies = JSON.parse('<%- JSON.stringify(companies) %>');
    var voiceCampaigns = JSON.parse('<%- JSON.stringify(voiceCampaigns) %>');
    var voiceServices = JSON.parse('<%- JSON.stringify(voiceServices) %>');
    var chatServices = JSON.parse('<%- JSON.stringify(chatServices) %>');
    var mailServices = JSON.parse('<%- JSON.stringify(mailServices) %>');
</script>
<div class="card">
    <div class="panel panel-default card-filter p-t-35 p-b-8">
        <div class="card-filter-item">
            <div class="card-filter-item-label text-uppercase color-grey">Công ty</div>
            <div class="card-filter-item-input">
                <select id="filter-company" name="filter-company" class="selectpicker input" title="- Tất cả -">
                    <option value="">- Tất cả -</option>
                    <% for(var i = 0;i < companies.length;i++){ %>
                    <option value=<%- companies[i]._id %>><%- companies[i].name %></option>
                    <% } %>
                </select>
            </div>
        </div>
        <div class="card-filter-item">
            <div class="card-filter-item-label text-uppercase color-grey">gọi ra</div>
            <div class="card-filter-item-input">
                <select id="filter-voice-campaign" name="filter-voice-campaign" class="selectpicker input"
                    title="- Tất cả -">
                    <option value="">- Tất cả -</option>
                    <% for(var i = 0;i < voiceCampaigns.length;i++){ %>
                    <option value=<%- voiceCampaigns[i]._id %>><%- voiceCampaigns[i].name %></option>
                    <% } %>
                </select>
            </div>
        </div>
        <div class="card-filter-item">
            <div class="card-filter-item-label text-uppercase color-grey">gọi vào</div>
            <div class="card-filter-item-input">
                <select id="filter-voice-service" name="filter-voice-service" class="selectpicker input"
                    title="- Tất cả -">
                    <option value="">- Tất cả -</option>
                    <% for(var i = 0;i < voiceServices.length;i++){ %>
                    <option value=<%- voiceServices[i]._id %>><%- voiceServices[i].name %></option>
                    <% } %>
                </select>
            </div>
        </div>
        <div class="card-filter-item">
            <div class="card-filter-item-label text-uppercase color-grey">chiến dịch chat</div>
            <div class="card-filter-item-input">
                <select id="filter-chat-service" name="filter-chat-service" class="selectpicker input"
                    title="- Tất cả -">
                    <option value="">- Tất cả -</option>
                    <% for(var i = 0;i < chatServices.length;i++){ %>
                    <option value=<%- chatServices[i]._id %>><%- chatServices[i].name %></option>
                    <% } %>
                </select>
            </div>
        </div>
        <div class="card-filter-item">
            <div class="card-filter-item-label text-uppercase color-grey">chiến dịch mail</div>
            <div class="card-filter-item-input">
                <select id="filter-mail-service" name="filter-mail-service" class="selectpicker input"
                    title="- Tất cả -">
                    <option value="">- Tất cả -</option>
                    <% for(var i = 0;i < mailServices.length;i++){ %>
                    <option value=<%- mailServices[i]._id %>><%- mailServices[i].name %></option>
                    <% } %>
                </select>
            </div>
        </div>

        <div class="card-filter-item">
            <div class="card-filter-item-label text-uppercase color-grey">từ ngày</div>
            <div class="card-filter-item-input">
                <div class="input-group">
                    <input type="text" class="form-control pull-right search-field date-picker filter-campain input"
                        id="filter-start-date" name="startDate" placeholder=" VD: 01/01/2018">
                    <span class="input-group-addon p-l-10 bgm-gray c-white"><i role="button"
                            class="zmdi zmdi-calendar"></i></span>
                </div>
            </div>
        </div>
        <div class="card-filter-item">
            <div class="card-filter-item-label text-uppercase color-grey">đến ngày</div>
            <div class="card-filter-item-input">
                <div class="input-group">
                    <input type="text" class="form-control pull-right search-field date-picker filter-campain input"
                        id="filter-end-date" name="filter-end-date" placeholder=" VD: 01/01/2018">
                    <span class="input-group-addon p-l-10 bgm-gray c-white"><i role="button"
                            class="zmdi zmdi-calendar"></i></span>
                </div>
            </div>
        </div>
        <div class="card-filter-item" style="width: 100%;">
            <div class="card-filter-item-label text-uppercase color-grey" style="opacity: 0;">search</div>
            <div class="card-filter-item-input">
                <a id="filter-btn" class="btn c-white bg-color-green" style="width:100%"><i
                        class="fa fa-search"></i></a>
            </div>
        </div>
    </div>
</div>

<div class="card p-b-8">

    <div class="block" style="display: flex;">
        <span class="text-uppercase color-grey" style="display: flex;align-items: center; padding-left: 12px;">báo cáo
            số lượng tương tác</span>
    </div>

    <div class="card-body table-responsive">
        <table class="table table-hover table-condensed table-bordered table-fix">
            <thead>
                <tr>
                    <th class="bgm-orange c-white text-center text-uppercase" rowspan="2"><span>công ty</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase" rowspan="2"><span>số lượng tương
                            tác</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase" rowspan="1" colspan="2"><span>tương tác
                            voice</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase" rowspan="1" colspan="2"><span>tương tác
                            chat</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase" rowspan="1" colspan="2"><span>tương tác
                            mail</span></th>
                </tr>
                <tr>
                    <th class="bgm-orange c-white text-center text-uppercase"><span>được phục vụ</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase"><span>bị nhỡ</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase"><span>đã được phục vụ</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase"><span>chưa được phục vụ</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase"><span>đã được phục vụ</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase"><span>chưa được phục vụ</span></th>
                </tr>
            </thead>
            <tbody>
                <%
            function pad(num) {
                return ("0"+num).slice(-2);
            }
            function hms(secs) {
                if(isNaN(secs)) return "0:00:00";
                var sec = Math.ceil(secs);
                var minutes = Math.floor(sec / 60);
                sec = sec%60;
                var hours = Math.floor(minutes/60)
                minutes = minutes%60;
                return hours+":"+pad(minutes)+":"+pad(sec);
            }
            function numberWithCommas(x) {
                if(!x) return '0';
                return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            }
            %>
                <%for(var i = 0; i < data.length;i++){%>
                <tr class="text-center" role="button" id="filter-detail-company" data-detail="<%- data[i]._id%>">
                    <td><%- (!!data[i].company ? data[i].company.name : '')%></td>
                    <td><%- numberWithCommas(data[i].voiceConnected + data[i].voiceNotConnected + data[i].chatConnected +
                        data[i].chatNotConnected + data[i].mailConnected + data[i].mailNotConnected)%></td>
                    <td><%- numberWithCommas(data[i].voiceConnected)%></td>
                    <td><%- numberWithCommas(data[i].voiceNotConnected)%></td>
                    <td><%- numberWithCommas(data[i].chatConnected)%></td>
                    <td><%- numberWithCommas(data[i].chatNotConnected)%></td>
                    <td><%- numberWithCommas(data[i].mailConnected)%></td>
                    <td><%- numberWithCommas(data[i].mailNotConnected)%></td>
                </tr>
                <%}%>
            </tbody>
        </table>
        <div id="container">
        </div>
    </div>
</div>

<div class="card p-b-8">
    <div class="block" style="display: flex;">
        <span class="text-uppercase color-grey" style="display: flex;align-items: center; padding-left: 12px;">chi tiết dự án</span>
    </div>

    <div class="card-body table-responsive">
        <table id="table-detail-company" class="table table-hover table-condensed table-bordered table-fix">
            <thead>
                <tr>
                    <th class="bgm-orange c-white text-center text-uppercase" rowspan="2"><span>công ty</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase" rowspan="2"><span>chiến dịch</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase" rowspan="2"><span>số lượng tương
                            tác</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase" rowspan="1" colspan="2"><span>tương tác
                            voice</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase" rowspan="1" colspan="2"><span>tương tác
                            chat</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase" rowspan="1" colspan="2"><span>tương tác
                            mail</span></th>
                </tr>
                <tr>
                    <th class="bgm-orange c-white text-center text-uppercase"><span>được phục vụ</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase"><span>bị nhỡ</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase"><span>đã được phục vụ</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase"><span>chưa được phục vụ</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase"><span>đã được phục vụ</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase"><span>chưa được phục vụ</span></th>
                </tr>
            </thead>
            <tbody>
                <% if(!!dataCompany){ %>
                <%for(var i = 0; i < dataCompany.length;i++){%>
                <% if(!!dataCompany[i].voiceService){ %><tr class="text-center" role="button" id="filter-detail-service"
                    data-detail="<%- dataCompany[i].voiceService._id%>"><%}%>
                <% if(!!dataCompany[i].voiceCampaign){ %>
                <tr class="text-center" role="button" id="filter-detail-service"
                    data-detail="<%- dataCompany[i].voiceCampaign._id%>"><%}%>
                <% if(!!dataCompany[i].chatService){ %>
                <tr class="text-center" role="button" id="filter-detail-service"
                    data-detail="<%- dataCompany[i].chatService._id%>"><%}%>
                <% if(!!dataCompany[i].mailService){ %>
                <tr class="text-center" role="button" id="filter-detail-service"
                    data-detail="<%- dataCompany[i].mailService._id%>"><%}%>
                    <td><%- (!!dataCompany[i].company ? dataCompany[i].company.name : '')%></td>
                    <% if(!!dataCompany[i].voiceService){ %><td><%- dataCompany[i].voiceService.name%></td><%}%>
                    <% if(!!dataCompany[i].voiceCampaign){ %><td><%- dataCompany[i].voiceCampaign.name%></td><%}%>
                    <% if(!!dataCompany[i].chatService){ %><td><%- dataCompany[i].chatService.name%></td><%}%>
                    <% if(!!dataCompany[i].mailService){ %><td><%- dataCompany[i].mailService.name%></td>
                    <%}%>
                    
                    <td><%- numberWithCommas(dataCompany[i].voiceConnected + dataCompany[i].voiceNotConnected + dataCompany[i].chatConnected +
                        dataCompany[i].chatNotConnected + dataCompany[i].mailConnected + dataCompany[i].mailNotConnected)%>
                    </td>
                    <td><%- numberWithCommas(dataCompany[i].voiceConnected)%></td>
                    <td><%- numberWithCommas(dataCompany[i].voiceNotConnected)%></td>
                    <td><%- numberWithCommas(dataCompany[i].chatConnected)%></td>
                    <td><%- numberWithCommas(dataCompany[i].chatNotConnected)%></td>
                    <td><%- numberWithCommas(dataCompany[i].mailConnected)%></td>
                    <td><%- numberWithCommas(dataCompany[i].mailNotConnected)%></td>
                </tr>
                <%}%>
            <% } %>
            </tbody>
        </table>
        <% if(!!pagingCompany && pagingCompany.totalResult > 0){ %>
        <div class="text-center p-t-20">
            <b>
                <span>Tổng</span>
                <span class="bold c-red"><%- pagingCompany.totalResult%></span>
            </b>
        </div>
        <div class="paginate text-center">
            <%
                var _startSymbol = pagingCompany.prelink.indexOf('?') >= 0 ? '&' : '?';
                %>
            <ul class="pagination ">
                <% if (pagingCompany.first) { %>
                <li><a
                        href="<%= pagingCompany.prelink + _startSymbol + 'pageCompany=' + pagingCompany.first %>">&laquo;</a>
                </li>
                <% } %>
                <% if (pagingCompany.previous) { %>
                <li><a
                        href="<%= pagingCompany.prelink + _startSymbol + 'pageCompany=' + pagingCompany.previous %>">&lsaquo;</a>
                </li>
                <% } %><% for ( var i = 0; i < pagingCompany.range.length; i++ ) { %>
                <% if(pagingCompany.range[i] == pagingCompany.current){ %>
                <li class="active"><span><%= pagingCompany.range[i] %></span></li>
                <% }else{ %>
                <li><a
                        href="<%= pagingCompany.prelink + _startSymbol %>pageCompany=<%= pagingCompany.range[i] %>"><%= pagingCompany.range[i] %></a>
                </li>
                <% } %><% } %>
                <% if (pagingCompany.next) { %>
                <li><a
                        href="<%= pagingCompany.prelink + _startSymbol + 'pageCompany=' + pagingCompany.next %>">&rsaquo;</a>
                </li>
                <% } %>
                <% if (pagingCompany.last) { %>
                <li><a
                        href="<%= pagingCompany.prelink + _startSymbol + 'pageCompany=' + pagingCompany.last %>">&raquo;</a>
                </li>
                <% } %>
            </ul>
        </div>
        <% } %>
    </div>
</div>

<div class="card p-b-8">

    <div class="block" style="display: flex;">
        <span class="text-uppercase color-grey" style="display: flex;align-items: center; padding-left: 12px;">chi tiết tương tác khách hàng</span>
    </div>

    <div class="card-body table-responsive">
        <table id="table-detail-service" class="table table-hover table-condensed table-bordered table-fix">
            <thead>
                <tr>
                    <th class="bgm-orange c-white text-center text-uppercase" rowspan="2"><span>họ tên</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase" rowspan="2"><span>số điện thoại</span>
                    </th>
                    <th class="bgm-orange c-white text-center text-uppercase" rowspan="2"><span>email</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase" rowspan="2"><span>công ty</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase" rowspan="2"><span>chiến dịch</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase" rowspan="2"><span>số lượng tương
                            tác</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase" rowspan="1" colspan="2"><span>tương tác
                            voice</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase" rowspan="1" colspan="2"><span>tương tác
                            chat</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase" rowspan="1" colspan="2"><span>tương tác
                            mail</span></th>
                </tr>
                <tr>
                    <th class="bgm-orange c-white text-center text-uppercase"><span>được phục vụ</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase"><span>bị nhỡ</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase"><span>đã được phục vụ</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase"><span>chưa được phục vụ</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase"><span>đã được phục vụ</span></th>
                    <th class="bgm-orange c-white text-center text-uppercase"><span>chưa được phục vụ</span></th>
                </tr>
            </thead>
            <tbody>
                <% if(!!dataService){ %>
                <%for(var i = 0; i < dataService.length;i++){%>
                <tr class="text-center">
                    <td><%- (!!dataService[i]._id ? dataService[i]._id.displayName : '')%></td>
                    <td><%- (!!dataService[i]._id ? dataService[i]._id.phone : '')%></td>
                    <td><%- (!!dataService[i]._id ? dataService[i]._id.email : '')%></td>
                    <td><%- (!!dataService[i].company ? dataService[i].company.name : '')%></td>
                    <% if(!!dataService[i].voiceService){ %><td><%- dataService[i].voiceService.name%></td><%}%>
                            <% if(!!dataService[i].voiceCampaign){ %><td><%- dataService[i].voiceCampaign.name%></td><%}%>
                            <% if(!!dataService[i].chatService){ %><td><%- dataService[i].chatService.name%></td><%}%>
                            <% if(!!dataService[i].mailService){ %><td><%- dataService[i].mailService.name%></td>
                    <%}%>
                            
                            <td><%- numberWithCommas(dataService[i].voiceConnected + dataService[i].voiceNotConnected + dataService[i].chatConnected +
                                dataService[i].chatNotConnected + dataService[i].mailConnected + dataService[i].mailNotConnected)%>
                    </td>
                    <td><%- numberWithCommas(dataService[i].voiceConnected)%></td>
                    <td><%- numberWithCommas(dataService[i].voiceNotConnected)%></td>
                    <td><%- numberWithCommas(dataService[i].chatConnected)%></td>
                    <td><%- numberWithCommas(dataService[i].chatNotConnected)%></td>
                    <td><%- numberWithCommas(dataService[i].mailConnected)%></td>
                    <td><%- numberWithCommas(dataService[i].mailNotConnected)%></td>
                </tr>
                <%}%>
                <% } %>
            </tbody>
        </table>
        <% if(!!pagingService && pagingService.totalResult > 0){ %>
        <div class="text-center p-t-20">
            <b>
                <span>Tổng</span>
                <span class="bold c-red"><%- pagingService.totalResult%></span>
            </b>
        </div>
        <div class="paginate text-center">
            <%
                    var _startSymbol = pagingService.prelink.indexOf('?') >= 0 ? '&' : '?';
                    %>
            <ul class="pagination ">
                <% if (pagingService.first) { %>
                <li><a
                        href="<%= pagingService.prelink + _startSymbol + 'pageService=' + pagingService.first %>">&laquo;</a>
                </li>
                <% } %>
                <% if (pagingService.previous) { %>
                <li><a
                        href="<%= pagingService.prelink + _startSymbol + 'pageService=' + pagingService.previous %>">&lsaquo;</a>
                </li>
                <% } %><% for ( var i = 0; i < pagingService.range.length; i++ ) { %>
                <% if(pagingService.range[i] == pagingService.current){ %>
                <li class="active"><span><%= pagingService.range[i] %></span></li>
                <% }else{ %>
                <li><a
                        href="<%= pagingService.prelink + _startSymbol %>pageService=<%= pagingService.range[i] %>"><%= pagingService.range[i] %></a>
                </li>
                <% } %><% } %>
                <% if (pagingService.next) { %>
                <li><a
                        href="<%= pagingService.prelink + _startSymbol + 'pageService=' + pagingService.next %>">&rsaquo;</a>
                </li>
                <% } %>
                <% if (pagingService.last) { %>
                <li><a
                        href="<%= pagingService.prelink + _startSymbol + 'pageService=' + pagingService.last %>">&raquo;</a>
                </li>
                <% } %>
            </ul>
        </div>
        <% } %>
    </div>
</div>